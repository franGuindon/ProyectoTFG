\chapter{The Rangerx Artifact Detection System}
\label{ch:solucion}

\section{Artifact Detection System Structure}
\label{sec:sol_struct}

The Artifact Detection System generates detection masks from frames with artifacts. These masks are white on macroblocks which contain artifacts and black on the remaining artifacts. Figure \ref{fig:detector_overview} illustrates the input frame with artifacts, which is processed by the system, and finally produces the detection masks.

\begin{figure} [!h]
  \centering
  
  \includegraphics{detector_general}
  
  \caption{General Artifact Detection System Overview. }
  \label{fig:detector_overview}

\end{figure}

In order to achieve this, the Artifact Detection System must first extract features from the input frame. These features become the inputs to the RDF Classifier. The RDF Classifier outputs a prediction vector. The prediction vector is then mapped to the binary mask output. Figure \ref{fig:detector_steps} illustrates these steps.

\begin{figure} [!h]
  \centering
  
  \includegraphics{detector_steps}
  
  \caption{Artifact Detection process. }
  \label{fig:detector_steps}

\end{figure}

This structure was used in the dispTEC2-2022 RDF system. The Rangerx system maintains this structure and improves over the previous system by increasing the training dataset size, by redesigning the Feature Extractor and by replacing the previous RDF library with the Ranger C++ Core Library.

Section \ref{sec:sol_dataset} details the dataset construction and expansion procedure. Section \ref{sec:sol_metrics} explains the main strategies Rangerx uses to improve performance on the detection task, as measured by the Precision and Recall Metrics. This section details out the Rangerx Feature Extractor design. Section \ref{sec:sol_speed} discusses the optimizations used in Rangerx to improve on the previous system's speed. This section justifies the use of Ranger as the new RDF backend. Section \ref{sec:sol_maskgen} is a brief explanation of the Rangerx Mask Generator (This Generator is identical to the one used in dispTEC2-2022). Section \ref{sec:sol_maskgen} is a brief explanation of the Rangerx Mask Generator (This Generator is identical to the one used in dispTEC2-2022). Finally, Section \ref{sec:sol_traintest} elaborates on the training and testing procedures.

\section{Building and Expanding the Dataset}
\label{sec:sol_dataset}

The first step in expanding the training dataset is to obtain more base videos. Each new video is inspected manually in order to identify several locations of interest within the video. These locations are then described in a Video Snipping Specification File, used to then snip sets of 200 frames from each specified location. Figure \ref{fig:framesetgen} describes the creation of the frame sets.

\begin{figure} [!h]
  \centering
  
  \includegraphics{framesetgen}
  
  \caption{Frameset Generation procedure.}
  \label{fig:framesetgen}

\end{figure}

The locations of interest are chosen according to a subjective assessment of video content type. The project's dataset expansion goal is to have at least 18 different video content types, and the dataset must at least include video in 3 different lighting scenarios.

Each frame set undergoes a Ground Truth Generation procedure in order to generate the corresponding label set, as described in Figure \ref{fig:labeler_steps}. In this procedure, the frame is encoded using H264

\begin{figure} [!h]
  \centering
  
  \includegraphics{simulator}
  
  \caption{H264 Packet Loss Simulation procedure}
  \label{fig:simulator}

\end{figure}

These videos are preferably stored using H264 encoding and I420 frame format, since the video frames will be reencoded and redecoded during the loss simulation process. By

\section{Improving the Detection Metrics}
\label{sec:sol_metrics}

\subsection{The Feature Extractor}
\label{sec:sol_features}

Input frames follow the I420 format. Rangerx only considers the luma component of the frame, since luma statistics correlate with artifacts much better than chroma statistics.

Figure \ref{fig:extractor_steps} describes the feature extraction strategy used in Rangerx. The new feature extractor applies a 2D High Pass Filter on the input image, which outputs a horizontally filtered frame and a vertically filtered frame.

\begin{figure} [!h]
  \centering
  
  \includegraphics{extractor_steps}
  
  \caption{Feature extraction process. }
  \label{fig:extractor_steps}

\end{figure}

\section{Improving the Detection Speed}
\label{sec:sol_speed}

\subsection{The Ranger C++ Core Library}
\label{sec:sol_rdf}

\section{The Mask Generator}
\label{sec:sol_maskgen}

\section{Training and Testing}
\label{sec:sol_traintest}


